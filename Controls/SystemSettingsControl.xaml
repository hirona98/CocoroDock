<UserControl x:Class="CocoroDock.Controls.SystemSettingsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="800"
             d:DesignWidth="800">

    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- 通知API設定 -->
                <GroupBox Header="通知API"
                          Margin="0,0,20,20"
                          Padding="10">
                    <StackPanel>
                        <!-- 説明テキスト -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#666666">
                            REST APIで受信した通知をキャラクターが教えてくれます
                        </TextBlock>

                        <!-- 通知要求を受けるチェックボックス -->
                        <CheckBox x:Name="IsEnableNotificationApiCheckBox"
                                  Content="通知要求を受ける"
                                  Margin="0,10,0,0"
                                  Foreground="#FF4873CF"
                                  ToolTip="Enable notification API"/>
                        <!-- API詳細（エンドポイント/ボディ/レスポンス/使用例をすべて折りたたみ） -->
                        <Expander x:Name="ApiDetailsExpander"
                                  Header="API詳細"
                                  Foreground="#666666"
                                  IsExpanded="False"
                                  Margin="0,10,0,0">
                            <TextBox x:Name="ApiDetailsTextBox"
                                     IsReadOnly="True"
                                     BorderThickness="0"
                                     VerticalScrollBarVisibility="Auto"
                                     Foreground="#666666"
                                     TextWrapping="Wrap"
                                     AcceptsReturn="True"
                                     Margin="0,10,0,0"/>
                        </Expander>
                    </StackPanel>
                </GroupBox>

                <!-- デスクトップウォッチ設定 -->
                <GroupBox Header="デスクトップウォッチ"
                          Margin="0,0,20,20"
                          Padding="10">
                    <StackPanel>
                        <!-- 説明テキスト -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#666666"
                                   Margin="0,0,0,10">
                            デスクトップの画面を定期的に取得し、内容に応じたコメントをします。マルチモーダルモデルが必要です。
                            <LineBreak/>
                            意図せずともセンシティブな画像を送るとアカウント停止の可能性がありますので注意してください。
                        </TextBlock>

                        <!-- ウォッチ機能の有効/無効設定 -->
                        <CheckBox x:Name="ScreenshotEnabledCheckBox"
                                  Content="デスクトップウォッチを有効にする（LLMに画像を送信します）"
                                  Margin="0,5,0,5"
                                  Foreground="#FF4873CF"
                                  ToolTip="Enable desktop monitoring"/>

                        <!-- アクティブウィンドウのみ設定 -->
                        <CheckBox x:Name="CaptureActiveWindowOnlyCheckBox"
                                  Content="アクティブウィンドウだけを対象にする"
                                  Margin="0,10,0,5"
                                  Foreground="#FF4873CF"
                                  ToolTip="Capture active window only"/>

                        <!-- ウォッチ間隔設定 -->
                        <Grid Margin="0,5,0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="28"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="ウォッチ間隔:"
                                       VerticalAlignment="Center"
                                       Height="19"/>
                            <TextBox Grid.Column="1"
                                     x:Name="ScreenshotIntervalTextBox"
                                     Foreground="#FF0078D7"
                                     VerticalAlignment="Center"
                                     Width="50"
                                     HorizontalAlignment="Left"
                                     Margin="10,0,10,0"/>
                            <TextBlock Grid.Column="2"
                                       Text="分"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left"/>
                        </Grid>

                        <!-- アイドルタイムアウト設定 -->
                        <Grid Margin="0,0,0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="28"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="アイドルタイムアウト:"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1"
                                     x:Name="IdleTimeoutTextBox"
                                     Foreground="#FF0078D7"
                                     VerticalAlignment="Center"
                                     Width="50"
                                     HorizontalAlignment="Left"
                                     Margin="10,0,10,0"/>
                            <TextBlock Grid.Column="2"
                                       Text="分"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left"/>
                        </Grid>

                        <!-- アイドルタイムアウト説明テキスト -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#666666">
                            ※マウスやキーボードの操作がない時間が設定値を超えると、デスクトップウォッチを一時停止します。
                        </TextBlock>
                    </StackPanel>
                </GroupBox>

                <!-- マイク設定 -->
                <GroupBox Header="マイク設定"
                          Margin="0,0,20,20"
                          Padding="10">
                    <StackPanel>
                        <!-- 説明テキスト -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#666666"
                                   Margin="0,0,0,10">
                            音声認識時のマイク入力感度を調整します。音声認識が有効なキャラクターに適用されます。
                        </TextBlock>

                        <!-- しきい値設定 -->
                        <Grid Margin="0,5,0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="60"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="入力しきい値:"
                                       VerticalAlignment="Center"/>
                            <Slider Grid.Column="1"
                                    x:Name="MicThresholdSlider"
                                    Minimum="-50"
                                    Maximum="0"
                                    Value="-45"
                                    TickFrequency="10"
                                    TickPlacement="BottomRight"
                                    Margin="10,0,10,0"/>
                            <TextBlock Grid.Column="2"
                                       Text="{Binding ElementName=MicThresholdSlider, Path=Value, StringFormat='{}{0:0} dB'}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"/>
                        </Grid>

                        <!-- しきい値説明テキスト -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#666666">
                            ※値が低いほど（-50dBに近いほど）音声を拾いやすくなりますが、環境音も拾いやすくなります。
                        </TextBlock>
                    </StackPanel>
                </GroupBox>

                <!-- インターネット検索設定 -->
                <GroupBox Header="インターネット検索設定"
                          Margin="0,0,20,20"
                          Padding="10">
                    <StackPanel>
                        <!-- 説明テキスト -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#666666">
                            高度な機能とインターネット検索機能の設定（実装中/OFFにしてください）
                        </TextBlock>

                        <!-- プロモード設定 -->
                        <CheckBox x:Name="EnableProModeCheckBox"
                                  Content="プロモードを有効にする"
                                  Margin="0,10,0,0"
                                  Foreground="#FF4873CF"
                                  ToolTip="Enable Pro Mode for advanced features"/>

                        <!-- インターネット検索設定 -->
                        <CheckBox x:Name="EnableInternetRetrievalCheckBox"
                                  Content="インターネット検索を有効にする"
                                  Margin="0,10,0,0"
                                  Foreground="#FF4873CF"
                                  ToolTip="Enable internet search capability"/>

                        <!-- Google API Key -->
                        <Grid Margin="0,10,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="130"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="Google API Key:"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1"
                                     x:Name="GoogleApiKeyTextBox"
                                     Foreground="#FF0078D7"
                                     VerticalAlignment="Center"
                                     Margin="10,0,0,0"/>
                        </Grid>

                        <!-- Google Search Engine ID -->
                        <Grid Margin="0,10,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="130"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="Search Engine ID:"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1"
                                     x:Name="GoogleSearchEngineIdTextBox"
                                     Foreground="#FF0078D7"
                                     VerticalAlignment="Center"
                                     Margin="10,0,0,0"/>
                        </Grid>

                        <!-- 最大検索結果数 -->
                        <Grid Margin="0,10,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="130"/>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text="最大検索結果数:"
                                       VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1"
                                     x:Name="InternetMaxResultsTextBox"
                                     Foreground="#FF0078D7"
                                     VerticalAlignment="Center"
                                     Margin="10,0,10,0"/>
                            <TextBlock Grid.Column="2"
                                       Text="（1-10）"
                                       VerticalAlignment="Center"
                                       Foreground="#666666"/>
                        </Grid>

                        <!-- 説明テキスト -->
                        <TextBlock TextWrapping="Wrap"
                                   Margin="0,10,0,0"
                                   Foreground="#666666">
                            ※Google Custom Search APIを使用する場合は、APIキーとSearch Engine IDが必要です。
                        </TextBlock>
                    </StackPanel>
                </GroupBox>

                <!-- 記憶管理設定 -->
                <GroupBox Header="記憶管理"
                          Margin="0,0,20,20"
                          Padding="10">
                    <StackPanel>
                        <!-- 説明テキスト -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#666666"
                                   Margin="0,0,0,10">
                            キャラクターの記憶を初期化します。この操作は取り消すことができません。
                        </TextBlock>

                        <!-- キャラクター選択 -->
                        <Grid Margin="0,5,0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0"
                                       Text="キャラクター:"
                                       VerticalAlignment="Center"/>

                            <ComboBox Grid.Column="1"
                                      x:Name="MemoryCharacterComboBox"
                                      Margin="10,0,10,0"
                                      DisplayMemberPath="DisplayName"
                                      SelectionChanged="MemoryCharacterComboBox_SelectionChanged"/>

                            <Button Grid.Column="2"
                                    x:Name="RefreshMemoryStatsButton"
                                    Content="更新"
                                    Width="60"
                                    Click="RefreshMemoryStatsButton_Click"
                                    ToolTip="ユーザー一覧と記憶統計情報を更新"/>
                        </Grid>

                        <!-- 記憶統計情報表示 -->
                        <Border BorderBrush="#E0E0E0"
                                BorderThickness="1"
                                CornerRadius="3"
                                Padding="10"
                                Margin="0,10,0,10"
                                Background="#F9F9F9">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- 選択中のキャラクター -->
                                <TextBlock Grid.Row="0"
                                           Grid.Column="0"
                                           Text="選択中:"
                                           Foreground="#666666"/>
                                <TextBlock Grid.Row="0"
                                           Grid.Column="1"
                                           x:Name="SelectedCharacterText"
                                           Text="未選択"
                                           FontWeight="Bold"
                                           Foreground="#4873CF"/>

                                <!-- 記憶数 -->
                                <TextBlock Grid.Row="1"
                                           Grid.Column="0"
                                           Text="記憶数:"
                                           Foreground="#666666"
                                           Margin="0,5,0,0"/>
                                <TextBlock Grid.Row="1"
                                           Grid.Column="1"
                                           x:Name="TotalMemoriesText"
                                           Text="0件"
                                           Margin="0,5,0,0"/>

                                <!-- 内訳 -->
                                <TextBlock Grid.Row="2"
                                           Grid.Column="0"
                                           Text="内訳:"
                                           Foreground="#666666"
                                           Margin="0,5,0,0"/>
                                <TextBlock Grid.Row="2"
                                           Grid.Column="1"
                                           x:Name="MemoryDetailsText"
                                           Text="テキスト: 0件 / アクティベーション: 0件 / パラメトリック: 0件"
                                           Foreground="#888888"
                                           Margin="0,5,0,0"
                                           FontSize="11"/>

                                <!-- 最終更新 -->
                                <TextBlock Grid.Row="3"
                                           Grid.Column="0"
                                           Text="最終更新:"
                                           Foreground="#666666"
                                           Margin="0,5,0,0"/>
                                <TextBlock Grid.Row="3"
                                           Grid.Column="1"
                                           x:Name="LastUpdatedText"
                                           Text="不明"
                                           Foreground="#888888"
                                           Margin="0,5,0,0"
                                           FontSize="11"/>
                            </Grid>
                        </Border>

                        <!-- アクションボタン -->
                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    Margin="0,10,0,0">
                            <Button x:Name="ShowMemoryDetailsButton"
                                    Content="詳細表示"
                                    Width="100"
                                    Margin="0,0,10,0"
                                    IsEnabled="False"
                                    Click="ShowMemoryDetailsButton_Click"
                                    ToolTip="記憶の詳細を表示（未実装）"/>

                            <Button x:Name="DeleteMemoryButton"
                                    Content="記憶を初期化"
                                    Width="100"
                                    Background="#DC3545"
                                    Foreground="White"
                                    IsEnabled="False"
                                    Click="DeleteMemoryButton_Click"
                                    ToolTip="選択中のキャラクターの記憶をすべて削除"/>
                        </StackPanel>

                        <!-- 警告メッセージ -->
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="#DC3545"
                                   Margin="0,10,0,0"
                                   FontSize="11">
                            ※記憶の初期化は取り消すことができません。実行前に必ず確認してください。
                        </TextBlock>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>